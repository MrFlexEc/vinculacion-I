<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Egreso</title>
     <!-- LIBRERIAS Y SCRIPT QUE SERAN USADOS PARA COMBO BOX Y POST --> 
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
    <link rel="icon" type="image/x-icon" href="https://i.ibb.co/Ytrg4r9/Monograma-Logotipo-belleza-blanco-y-negro.png" >

    </head>
<body style="background-color: #C2D7DB; display: flex; flex-direction: column; min-height: 100vh;">
    <% if (login){ %>

        <% if (typeof alertas !== "undefined" && alertas.length > 0) { %>
            <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
            <script>
              document.addEventListener('DOMContentLoaded', async () => {
                const alertas = JSON.parse('<%- JSON.stringify(alertas) %>');
                
                for (let i = 0; i < alertas.length; i++) {
                  const alerta = alertas[i];
                  await Swal.fire({
                    icon: alerta.alertIcon,
                    title: alerta.alertTitle,
                    text: alerta.alertMessage,
                    showConfirmButton: i === alertas.length - 1 ? alerta.showConfirmButton : false,
                    timer: alerta.timer,
                  });
                }
              });
            </script>
          <% }; %>

   
          <nav class="navbar sticky-top " style="background-color:#385277 ;color: #a3c1d5;" >  
            <div class="container-fluid ">
                <div class="navbar-toggler-icon  z-1"><div class="px-5 z3 d-flex ">PROCESOS</div> </div> <!--icono-->
                    <img src="https://i.ibb.co/YBVfJJ8/Monograma-Logotipo-belleza-blanco-y-negro-removebg-preview.png" style=" margin-top: 77px;margin-left: 77%; ; max-width: 11rem; position: absolute;">
                    <div class="d-flex justify-content-end "> 
                        <input class="text-center" type="date" id="fecha" name="fecha" value="" readonly>
                    </div>
                </div>
                

            </div>
            
            <script>
                // Obtener la fecha actual
                var fechaActual = new Date();
                
                // Formatear la fecha para el valor del input
                var dd = String(fechaActual.getDate()).padStart(2, '0');
                var mm = String(fechaActual.getMonth() + 1).padStart(2, '0');
                var yyyy = fechaActual.getFullYear();
                var fechaFormateada = yyyy + '-' + mm + '-' + dd;
                
                // Asignar la fecha formateada al valor del input
                document.getElementById("fecha").value = fechaFormateada;
              </script>
 
          </div>
            
            <div class="d-flex justify-content-around" style="background-color: #385277;">
              <!--NAVEGACION -->
              <div class="p-3"> <a href="#seccionObservar" style="text-decoration: none; color: #a3c1d5;">Observar</a></div>
              <div class="p-3"> <a href="inventario" style="text-decoration: none; color: #a3c1d5;">Inventario</a></div>
              <div class="p-3"> <a href="crearRegistro" style="text-decoration: none; color: #a3c1d5;">Registrar</a></div>
              <div class="p-3"> <a href="crearProveedor" style="text-decoration: none; color: #a3c1d5;">Proveedor</a></div>
              <div class="p-3"> <a href="crearUsuario" style="text-decoration: none; color: #a3c1d5;">Usuario</a></div>
              <div class="p-3">
                  <li class="list-unstyled nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                      Historial
                    </a>
                    <ul class="dropdown-menu  "> 
                      <li> <a class="dropdown-item" href="Historial-Egreso">Egreso Historial</a></li>
                      <li> <a class="dropdown-item" href="Historial-Ingreso">Ingreso Historial</a></li>
                    </ul>
                  </li>
              </div>
             
            
            </div>
            <div class="px-4">
                  <div class="d-flex justify-content-end px-4"> 
                    
                  </div>
            </div>
        </nav>
</head>
    
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>
 <script type="text/javascript" src="https://cdn.datatables.net/v/bs4/dt-1.10.20/datatables.min.js"></script>  

<div class="p-3">
    <form action="/EgresoinventarioInventario" method="POST">
    <div class="row  m-1 ">
        <div class="col-sm-6 col-md-7 col-lg-7 col-xl-7 col-xxl-7  me-4 ">
            <table class="text-start table " id="registros"  > 
                <thead class="table-dark " style="color: #a3c1d5;">
                    <tr>
                        <th>Ver</th>
                        <th>Codigo</th>
                        <th>Nombre</th>
                        <th>Marca</th>
                        <th>Categoria</th>
                        <th>Cantidad</th>
                        <th>Cantidad Min - Max</th>
                        <th>Precio</th>
                    </tr>

                </thead>    
                <tbody>
                    <% resultadoInven?.forEach((INVEN) =>{ %>  
                        <% IDRESPUESTO=INVEN.IDRESPUESTO %>
                        <% CODIGO=INVEN.CODIGOREPUESTO %>
                        <% NOMBRE=INVEN.NOMBREREPUESTO %>
                        <% MARCA=INVEN.NOMBREMARCA %>
                        <% CATEGORIA=INVEN.NOMBRECATEGORIA %>
                        <% CANTIDAD=INVEN.CANTIDADREPUESTO %>
                        <% CANTIDADMIN=INVEN.MINCANREPUESTO %>
                        <% CANTIDADMAX=INVEN.MAXCANREPUESTO %>
                        <% PRECIO=INVEN.PUBLICOPRECIO %>
                    <tr>
                        <th>
                            <a href="/Data-ver/<%= IDRESPUESTO %>" class="btn btn-outline-info"><i class='bx bx-show'></i></a>
                        </th>
                        <th><%= CODIGO %></th>
                        <th><%= NOMBRE %></th>
                        <th><%= MARCA %></th>
                        <th><%= CATEGORIA %></th>
                        <th><%= CANTIDAD %></th>
                        <th><%= CANTIDADMIN %> - <%= CANTIDADMAX %></th>
                        <th>$<%= PRECIO %></th>

                    </tr>
                    
                    <% }); %>
                </tbody>
                <tfoot>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>

 
                    </tr>
                </tfoot>

            </table>
           
        </div>

        
        <div class="col-sm-5 col-md-4 col-lg-4 col-xl-4 col-xxl-4 pt-5 justify-content-start fs-4 px-4" style="color: #385277;    border-left-color: red;">
            <div class="container   ">
                <div style="font-size: 3rem; " class="">Ingreso - Egreso</div>
                <hr>
                Codigo
                <div class="opacity-75 ">
                    <select id="miSelect" name="codigoInventario" class="form-control ">
                        <option  disabled selected >Seleccione Codigo..</option>

                        <% Repuesto?.forEach((repuesto) =>{ %>  
                            <% id_repuesto= repuesto.IDRESPUESTO %>
                            <% codigo_repuesto= repuesto.CODIGOREPUESTO %>  
 
                        
                        <option value="<%= id_repuesto %>" style="color: #707070;"><%= codigo_repuesto%> </option>
                        <% }); %>
                        <!-- Agrega más opciones aquí -->
                    </select>
                    <script>
                        $(document).ready(function() {
                        $('#miSelect').select2();
                        $('#miSelect2').select2();

                        });
                    </script>
                </div>
                <div class="row ">
                    <div class="col-6 py-3">
                        Accion
                        <div class="opacity-75">
                            <select name="accionInventario" id="miSelect2" class="form-control ">
                                <option  disabled selected >Seleccione</option>
                                <option value="Ingreso" >Ingreso</option>
                                <option value="Egreso">Egreso</option> 
                            </select>
                        </div>

                    </div>
                    
                        <div class="col-6 py-3" > 
                            Cantidad
                            <div class="opacity-75 py-2 d-flex ">
                            <input type="text" name="cantidadInventario" class="form-control rounded-4 border-2" style="background-color: #99B3D8; color: black; border-color: #385277;">
                            </div>
                        </div>
                       

                    </div>
                    <div class="container ">
                        <div class="col-12  row">
                            <div class="col-2"></div>
                            <div class="col-8 "> 
                                
                                <div class=" d-flex">
                                    Fecha
                                    <input type="date" name="" class="form-control rounded-4 border-2 opacity-75" style="background-color: #99B3D8; color: black; border-color: #385277;">
                            
                                </div>
                            </div>
                            <div class="col-6"></div>

                        </div>
                       
                    </div>

                    </div>
                    

                    <div class="col-ms-6 col-md-12 col-lg-12 col-xl-12 col-xl-12 pt-2  ">
                        <button type="submit" class="btn rounded-5 border-3 form-control pt-4 pb-4" style="background-color: #81C79F; border-color: #707070;" >ACEPTAR</button>

                    </div>
                </div>

            </div>
                
                
        </div>

                    
                     
                


                  
            

        
    </div>
        <script>
    
        $(document).ready(function(){
            var table =$("#registros").DataTable({
                "language":{
                    "processing": "Procesando...",
                    "lengthMenu": "Mostrar _MENU_ registros",
                    "zeroRecords": "No se encontraron resultados",
                    "emptyTable": "Ningún dato disponible en esta tabla",
                    "infoEmpty": "Mostrando registros del 0 al 0 de un total de 0 registros",
                    "infoFiltered": "(filtrado de un total de _MAX_ registros)",
                    "search": "Buscar:",
                    "infoThousands": ",",
                    "loadingRecords": "Cargando...",
                    "paginate": {
                        "first": "Primero",
                        "last": "Último",
                        "next": "Siguiente",
                        "previous": "Anterior"
                    },
                    "aria": {
                        "sortAscending": ": Activar para ordenar la columna de manera ascendente",
                        "sortDescending": ": Activar para ordenar la columna de manera descendente"
                    },
                    "buttons": {
                        "copy": "Copiar",
                        "colvis": "Visibilidad",
                        "collection": "Colección",
                        "colvisRestore": "Restaurar visibilidad",
                        "copyKeys": "Presione ctrl o u2318 + C para copiar los datos de la tabla al portapapeles del sistema. <br \/> <br \/> Para cancelar, haga clic en este mensaje o presione escape.",
                        "copySuccess": {
                            "1": "Copiada 1 fila al portapapeles",
                            "_": "Copiadas %d fila al portapapeles"
                        },
                        "copyTitle": "Copiar al portapapeles",
                        "csv": "CSV",
                        "excel": "Excel",
                        "pageLength": {
                            "-1": "Mostrar todas las filas",
                            "1": "Mostrar 1 fila",
                            "_": "Mostrar %d filas"
                        },
                        "pdf": "PDF",
                        "print": "Imprimir"
                    },
                    "autoFill": {
                        "cancel": "Cancelar",
                        "fill": "Rellene todas las celdas con <i>%d<\/i>",
                        "fillHorizontal": "Rellenar celdas horizontalmente",
                        "fillVertical": "Rellenar celdas verticalmentemente"
                    },
                    "decimal": ",",
                    "searchBuilder": {
                        "add": "Añadir condición",
                        "button": {
                            "0": "Constructor de búsqueda",
                            "_": "Constructor de búsqueda (%d)"
                        },
                        "clearAll": "Borrar todo",
                        "condition": "Condición",
                        "conditions": {
                            "date": {
                                "after": "Despues",
                                "before": "Antes",
                                "between": "Entre",
                                "empty": "Vacío",
                                "equals": "Igual a",
                                "notBetween": "No entre",
                                "notEmpty": "No Vacio",
                                "not": "Diferente de"
                            },
                            "number": {
                                "between": "Entre",
                                "empty": "Vacio",
                                "equals": "Igual a",
                                "gt": "Mayor a",
                                "gte": "Mayor o igual a",
                                "lt": "Menor que",
                                "lte": "Menor o igual que",
                                "notBetween": "No entre",
                                "notEmpty": "No vacío",
                                "not": "Diferente de"
                            },
                            "string": {
                                "contains": "Contiene",
                                "empty": "Vacío",
                                "endsWith": "Termina en",
                                "equals": "Igual a",
                                "notEmpty": "No Vacio",
                                "startsWith": "Empieza con",
                                "not": "Diferente de"
                            },
                            "array": {
                                "not": "Diferente de",
                                "equals": "Igual",
                                "empty": "Vacío",
                                "contains": "Contiene",
                                "notEmpty": "No Vacío",
                                "without": "Sin"
                            }
                        },
                        "data": "Data",
                        "deleteTitle": "Eliminar regla de filtrado",
                        "leftTitle": "Criterios anulados",
                        "logicAnd": "Y",
                        "logicOr": "O",
                        "rightTitle": "Criterios de sangría",
                        "title": {
                            "0": "Constructor de búsqueda",
                            "_": "Constructor de búsqueda (%d)"
                        },
                        "value": "Valor"
                    },
                    "searchPanes": {
                        "clearMessage": "Borrar todo",
                        "collapse": {
                            "0": "Paneles de búsqueda",
                            "_": "Paneles de búsqueda (%d)"
                        },
                        "count": "{total}",
                        "countFiltered": "{shown} ({total})",
                        "emptyPanes": "Sin paneles de búsqueda",
                        "loadMessage": "Cargando paneles de búsqueda",
                        "title": "Filtros Activos - %d"
                    },
                    "select": {
                        "1": "%d fila seleccionada",
                        "_": "%d filas seleccionadas",
                        "cells": {
                            "1": "1 celda seleccionada",
                            "_": "$d celdas seleccionadas"
                        },
                        "columns": {
                            "1": "1 columna seleccionada",
                            "_": "%d columnas seleccionadas"
                        }
                    },
                    "thousands": ".",
                    "datetime": {
                        "previous": "Anterior",
                        "next": "Proximo",
                        "hours": "Horas",
                        "minutes": "Minutos",
                        "seconds": "Segundos",
                        "unknown": "-",
                        "amPm": [
                            "am",
                            "pm"
                        ]
                    },
                    "editor": {
                        "close": "Cerrar",
                        "create": {
                            "button": "Nuevo",
                            "title": "Crear Nuevo Registro",
                            "submit": "Crear"
                        },
                        "edit": {
                            "button": "Editar",
                            "title": "Editar Registro",
                            "submit": "Actualizar"
                        },
                        "remove": {
                            "button": "Eliminar",
                            "title": "Eliminar Registro",
                            "submit": "Eliminar",
                            "confirm": {
                                "_": "¿Está seguro que desea eliminar %d filas?",
                                "1": "¿Está seguro que desea eliminar 1 fila?"
                            }
                        },
                        "error": {
                            "system": "Ha ocurrido un error en el sistema (<a target=\"\\\" rel=\"\\ nofollow\" href=\"\\\">Más información&lt;\\\/a&gt;).<\/a>"
                        },
                        "multi": {
                            "title": "Múltiples Valores",
                            "info": "Los elementos seleccionados contienen diferentes valores para este registro. Para editar y establecer todos los elementos de este registro con el mismo valor, hacer click o tap aquí, de lo contrario conservarán sus valores individuales.",
                            "restore": "Deshacer Cambios",
                            "noMulti": "Este registro puede ser editado individualmente, pero no como parte de un grupo."
                        }
                    },
                    "info": "Mostrando de _START_ a _END_ de _TOTAL_ entradas"
                } 
            });
            
        });
      
        
    </script>
    <style>
        /* Aqui se cambia el fondo de el cuadro de busqueda donde se escribe y el color del texto*/
        .select2-container .select2-search input {
        background-color: #99B3D8;
        color: black;
        
    }
    

        /* Aqui se cambia el fondo de el cuadro antes de desplegarse y el color de texto de este*/
        .select2-selection__rendered {
        background-color: #99B3D8;
        padding-top: 9px;
        border-radius: 5px;
        text-align: center;
        /* Color y tamaño del borde del combo box*/
        border: 2px solid #385277;
        font-size: 20px;

    }

    /* Se cambia el color del texto en las opciones desplegadas y el color de fondo de este*/
    .select2-results__option {
         color: black;
         background-color: #99B3D8;

        }   

    


    </style>

    


</div>
    </form>
    <footer class="p-3  z-3 " style="background-color:#385277 ; margin-top: auto;  ">
            <a href="/home">
            <label style="color: white;">HOME</label><img src="https://i.ibb.co/QF1WGmT/casa-1.png" style="height: 2rem; ">
            </a>
    </footer> 
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js" integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS" crossorigin="anonymous"></script>

    <!-- algunos scripts que seran necesarios para combo box  -->  
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script> 
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
     <!-- LIBRERIAS Y SCRIPT DOC-ANTERIOR --> 
    
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs4/dt-1.10.20/datatables.min.js"></script>  
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4/dt-1.10.20/datatables.min.css"/>  
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css">
     <!-- USAR ICONO --> 
     <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"  crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js" integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS" crossorigin="anonymous"></script>
    <% } else { %>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <% if (InventarioEY) { %>
        <% if (typeof alert != "undefined") { %>
            <script>
                Swal.fire({
                title: '<%= alertTitle %>',
                text:'<%= alertMessage %>',
                icon: '<%= alertIcon %>',
                showConfirmButton:<%= showConfirmButton %>,
                timer:<%= timer %>
                }).then(()=>{
                    window.location='./<%= ruta %>'
                })
            </script>
        <% }; %>
        <% } else { %>
            <% if (typeof alert != "undefined") { %>
                <script>
                    Swal.fire({
                    title: '<%= alertTitle %>',
                    text:'<%= alertMessage %>',
                    icon: '<%= alertIcon %>',
                    showConfirmButton:<%= showConfirmButton %>,
                    timer:<%= timer %>
                    }).then(()=>{
                        window.history.go(-1)
                    })
                </script>
            <% }; %>
            <% } %> 
        <% } %>
</body>
</html>
